import"./modulepreload-polyfill-B5Qt9EMX.js";import{T as it,E as fe,a as u,b as Ye,e as nt,l as st,c as rt,g as se,d as Oe,r as ot,f as lt,u as ze,h as at,i as ht,j as ct,k as ut,m as de,n as dt,o as v,p as gt,q as be,D as Ge,t as D,s as Ze,v as ft,w as Tt,x as te,y as ie,z as Te,A as Me,B as me,M as mt,C as _t,F as xt,G as Ue,S as Et,H as N,I as pt,J as Rt,K as Ct,L as I,N as yt,O as wt,P as Ft,Q as je,R as ve,U as Xe,V as Ae,W as St,X as Pt,Y as Lt,Z as It,_ as Ot,$ as zt,a0 as jt,a1 as vt,a2 as Xt}from"./Image-1T6Htkhg.js";class ke extends it{constructor(e,t,i){super(),i=i||{},this.tileCoord=e,this.state=t,this.interimTile=null,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(fe.CHANGE)}release(){this.state===u.ERROR&&this.setState(u.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let e=this.interimTile;if(!e)return this;do{if(e.getState()==u.LOADED)return this.transition_=0,e;e=e.interimTile}while(e);return this}refreshInterimChain(){let e=this.interimTile;if(!e)return;let t=this;do{if(e.getState()==u.LOADED){e.interimTile=null;break}e.getState()==u.LOADING?t=e:e.getState()==u.IDLE?t.interimTile=e.interimTile:t=e,e=t.interimTile}while(e)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==u.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}load(){Ye()}getAlpha(e,t){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=t,this.transitionStarts_[e]=i;else if(i===-1)return 1;const n=t-i+1e3/60;return n>=this.transition_?1:nt(n/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}}class Ke extends ke{constructor(e,t,i,n,s,r){super(e,t,r),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,n!==null&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=u.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=u.ERROR,this.unlistenImage_(),this.image_=At(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=u.LOADED:this.state=u.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==u.ERROR&&(this.state=u.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==u.IDLE&&(this.state=u.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=st(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function At(){const o=rt(1,1);return o.fillStyle="rgba(0,0,0,0)",o.fillRect(0,0,1,1),o.canvas}class ge extends ke{constructor(e,t,i,n,s,r,l,h,a,c,d,m){super(s,u.IDLE,m),this.renderEdges_=d!==void 0?d:!1,this.pixelRatio_=l,this.gutter_=h,this.canvas_=null,this.sourceTileGrid_=t,this.targetTileGrid_=n,this.wrappedTileCoord_=r||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const T=n.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let g=this.sourceTileGrid_.getExtent();const y=f?se(T,f):T;if(Oe(y)===0){this.state=u.EMPTY;return}const x=e.getExtent();x&&(g?g=se(g,x):g=x);const E=n.getResolution(this.wrappedTileCoord_[0]),p=ct(e,i,y,E);if(!isFinite(p)||p<=0){this.state=u.EMPTY;return}const R=c!==void 0?c:dt;if(this.triangulation_=new ut(e,i,y,g,p*R,E),this.triangulation_.getTriangles().length===0){this.state=u.EMPTY;return}this.sourceZ_=t.getZForResolution(p);let C=this.triangulation_.calculateSourceExtent();if(g&&(e.canWrapX()?(C[1]=de(C[1],g[1],g[3]),C[3]=de(C[3],g[1],g[3])):C=se(C,g)),!Oe(C))this.state=u.EMPTY;else{const w=t.getTileRangeForExtentAndZ(C,this.sourceZ_);for(let b=w.minX;b<=w.maxX;b++)for(let O=w.minY;O<=w.maxY;O++){const Y=a(this.sourceZ_,b,O,l);Y&&this.sourceTiles_.push(Y)}this.sourceTiles_.length===0&&(this.state=u.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{t&&t.getState()==u.LOADED&&e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})}),this.sourceTiles_.length=0,e.length===0)this.state=u.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),n=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],r=this.targetTileGrid_.getResolution(t),l=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=ot(n,s,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),r,h,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=u.LOADED}this.changed()}load(){if(this.state==u.IDLE){this.state=u.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const i=t.getState();if(i==u.IDLE||i==u.LOADING){e++;const n=lt(t,fe.CHANGE,function(s){const r=t.getState();(r==u.LOADED||r==u.ERROR||r==u.EMPTY)&&(ze(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(n)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t,i,n){t.getState()==u.IDLE&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ze),this.sourcesListenerKeys_=null}release(){this.canvas_&&(at(this.canvas_.getContext("2d")),ht.push(this.canvas_),this.canvas_=null),super.release()}}class Dt{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let t=this.oldest_;for(;t;)e(t.value_,t.key_,this),t=t.newer}get(e,t){const i=this.entries_[e];return v(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const t=this.entries_[e];return v(t!==void 0,"Tried to get a value for a key that does not exist in the cache"),t===this.newest_?(this.newest_=t.older,this.newest_&&(this.newest_.newer=null)):t===this.oldest_?(this.oldest_=t.newer,this.oldest_&&(this.oldest_.older=null)):(t.newer.older=t.older,t.older.newer=t.newer),delete this.entries_[e],--this.count_,t.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.key_;return e}getValues(){const e=new Array(this.count_);let t=0,i;for(i=this.newest_;i;i=i.older)e[t++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var t;return(t=this.entries_[e])==null?void 0:t.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,t){this.get(e),this.entries_[e].value_=t}set(e,t){v(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:t};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function De(o,e,t,i){return i!==void 0?(i[0]=o,i[1]=e,i[2]=t,i):[o,e,t]}function re(o,e,t){return o+"/"+e+"/"+t}function qe(o){return re(o[0],o[1],o[2])}function Yt(o){return o.split("/").map(Number)}function bt(o){return(o[1]<<o[0])+o[2]}function Gt(o,e){const t=o[0],i=o[1],n=o[2];if(e.getMinZoom()>t||t>e.getMaxZoom())return!1;const s=e.getFullTileRange(t);return s?s.containsXY(i,n):!0}class Ne extends Dt{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(e){for(;this.canExpireCache()&&!(this.peekLast().getKey()in e);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const e=this.peekFirstKey(),i=Yt(e)[0];this.forEach(n=>{n.tileCoord[0]!==i&&(this.remove(qe(n.tileCoord)),n.release())})}}const ue={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class _e{constructor(e,t,i,n){this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,t){return this.minX<=e&&e<=this.maxX&&this.minY<=t&&t<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function K(o,e,t,i,n){return n!==void 0?(n.minX=o,n.maxX=e,n.minY=t,n.maxY=i,n):new _e(o,e,t,i)}const q=[0,0,0],A=5;class Zt{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,v(gt(this.resolutions_,(n,s)=>s-n,!0),"`resolutions` must be sorted in descending order");let t;if(!e.origins){for(let n=0,s=this.resolutions_.length-1;n<s;++n)if(!t)t=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==t){t=void 0;break}}this.zoomFactor_=t,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,v(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=be(i)),v(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,v(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Ge,v(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((n,s)=>{const r=new _e(Math.min(0,n[0]),Math.max(n[0]-1,-1),Math.min(0,n[1]),Math.max(n[1]-1,-1));if(i){const l=this.getTileRangeForExtentAndZ(i,s);r.minX=Math.max(l.minX,r.minX),r.maxX=Math.min(l.maxX,r.maxX),r.minY=Math.max(l.minY,r.minY),r.maxY=Math.min(l.maxY,r.maxY)}return r}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,t,i){const n=this.getTileRangeForExtentAndZ(e,t);for(let s=n.minX,r=n.maxX;s<=r;++s)for(let l=n.minY,h=n.maxY;l<=h;++l)i([t,s,l])}forEachTileCoordParentTileRange(e,t,i,n){let s,r,l,h=null,a=e[0]-1;for(this.zoomFactor_===2?(r=e[1],l=e[2]):h=this.getTileCoordExtent(e,n);a>=this.minZoom;){if(r!==void 0&&l!==void 0?(r=Math.floor(r/2),l=Math.floor(l/2),s=K(r,r,l,l,i)):s=this.getTileRangeForExtentAndZ(h,a,i),t(a,s))return!0;--a}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,t,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,r=e[2]*2;return K(s,s+1,r,r+1,t)}const n=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,e[0]+1,t)}return null}getTileRangeForTileCoordAndZ(e,t,i){if(t>this.maxZoom||t<this.minZoom)return null;const n=e[0],s=e[1],r=e[2];if(t===n)return K(s,r,s,r,i);if(this.zoomFactor_){const h=Math.pow(this.zoomFactor_,t-n),a=Math.floor(s*h),c=Math.floor(r*h);if(t<n)return K(a,a,c,c,i);const d=Math.floor(h*(s+1))-1,m=Math.floor(h*(r+1))-1;return K(a,d,c,m,i)}const l=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,t,i)}getTileRangeForExtentAndZ(e,t,i){this.getTileCoordForXYAndZ_(e[0],e[3],t,!1,q);const n=q[1],s=q[2];this.getTileCoordForXYAndZ_(e[2],e[1],t,!0,q);const r=q[1],l=q[2];return K(n,r,s,l,i)}getTileCoordCenter(e){const t=this.getOrigin(e[0]),i=this.getResolution(e[0]),n=D(this.getTileSize(e[0]),this.tmpSize_);return[t[0]+(e[1]+.5)*n[0]*i,t[1]-(e[2]+.5)*n[1]*i]}getTileCoordExtent(e,t){const i=this.getOrigin(e[0]),n=this.getResolution(e[0]),s=D(this.getTileSize(e[0]),this.tmpSize_),r=i[0]+e[1]*s[0]*n,l=i[1]-(e[2]+1)*s[1]*n,h=r+s[0]*n,a=l+s[1]*n;return Ze(r,l,h,a,t)}getTileCoordForCoordAndResolution(e,t,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],t,!1,i)}getTileCoordForXYAndResolution_(e,t,i,n,s){const r=this.getZForResolution(i),l=i/this.getResolution(r),h=this.getOrigin(r),a=D(this.getTileSize(r),this.tmpSize_);let c=l*(e-h[0])/i/a[0],d=l*(h[1]-t)/i/a[1];return n?(c=te(c,A)-1,d=te(d,A)-1):(c=ie(c,A),d=ie(d,A)),De(r,c,d,s)}getTileCoordForXYAndZ_(e,t,i,n,s){const r=this.getOrigin(i),l=this.getResolution(i),h=D(this.getTileSize(i),this.tmpSize_);let a=(e-r[0])/l/h[0],c=(r[1]-t)/l/h[1];return n?(a=te(a,A)-1,c=te(c,A)-1):(a=ie(a,A),c=ie(c,A)),De(i,a,c,s)}getTileCoordForCoordAndZ(e,t,i){return this.getTileCoordForXYAndZ_(e[0],e[1],t,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,t){const i=ft(this.resolutions_,e,t||0);return de(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,t){return Tt(t,0,t.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const t=this.resolutions_.length,i=new Array(t);for(let n=this.minZoom;n<t;++n)i[n]=this.getTileRangeForExtentAndZ(e,n);this.fullTileRanges_=i}}const We=Zt;function He(o){let e=o.getDefaultTileGrid();return e||(e=Kt(o),o.setDefaultTileGrid(e)),e}function Mt(o,e,t){const i=e[0],n=o.getTileCoordCenter(e),s=xe(t);if(!Ue(s,n)){const r=me(s),l=Math.ceil((s[0]-n[0])/r);return n[0]+=r*l,o.getTileCoordForCoordAndZ(n,i)}return e}function Ut(o,e,t,i){i=i!==void 0?i:"top-left";const n=Be(o,e,t);return new We({extent:o,origin:_t(o,i),resolutions:n,tileSize:t})}function kt(o){const e=o||{},t=e.extent||Te("EPSG:3857").getExtent(),i={extent:t,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Be(t,e.maxZoom,e.tileSize,e.maxResolution)};return new We(i)}function Be(o,e,t,i){e=e!==void 0?e:xt,t=D(t!==void 0?t:Ge);const n=Me(o),s=me(o);i=i>0?i:Math.max(s/t[0],n/t[1]);const r=e+1,l=new Array(r);for(let h=0;h<r;++h)l[h]=i/Math.pow(2,h);return l}function Kt(o,e,t,i){const n=xe(o);return Ut(n,e,t,i)}function xe(o){o=Te(o);let e=o.getExtent();if(!e){const t=180*mt.degrees/o.getMetersPerUnit();e=Ze(-t,-t,t,t)}return e}class qt extends Et{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.opaque_=e.opaque!==void 0?e.opaque:!1,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const t=[256,256];this.tileGrid&&D(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),t),this.tileCache=new Ne(e.cacheSize||0),this.tmpSize=[0,0],this.key_=e.key||"",this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(e,t){const i=this.getTileCacheForProjection(e);i&&i.expireCache(t)}forEachLoadedTile(e,t,i,n){const s=this.getTileCacheForProjection(e);if(!s)return!1;let r=!0,l,h,a;for(let c=i.minX;c<=i.maxX;++c)for(let d=i.minY;d<=i.maxY;++d)h=re(t,c,d),a=!1,s.containsKey(h)&&(l=s.get(h),a=l.getState()===u.LOADED,a&&(a=n(l)!==!1)),a||(r=!1);return r}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getOpaque(e){return this.opaque_}getResolutions(e){const t=e?this.getTileGridForProjection(e):this.tileGrid;return t?t.getResolutions():null}getTile(e,t,i,n,s){return Ye()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:He(e)}getTileCacheForProjection(e){const t=this.getProjection();return v(t===null||N(t,e),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,t,i){const n=this.getTileGridForProjection(i),s=this.getTilePixelRatio(t),r=D(n.getTileSize(e),this.tmpSize);return s==1?r:pt(r,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,t){t=t!==void 0?t:this.getProjection();const i=this.getTileGridForProjection(t);return this.getWrapX()&&t.isGlobal()&&(e=Mt(i,e,t)),Gt(e,i)?e:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(e,t){const i=this.getTileCacheForProjection(t);e>i.highWaterMark&&(i.highWaterMark=e)}useTile(e,t,i,n){}}class Nt extends Rt{constructor(e,t){super(e),this.tile=t}}function Wt(o,e){const t=/\{z\}/g,i=/\{x\}/g,n=/\{y\}/g,s=/\{-y\}/g;return function(r,l,h){if(r)return o.replace(t,r[0].toString()).replace(i,r[1].toString()).replace(n,r[2].toString()).replace(s,function(){const a=r[0],c=e.getFullTileRange(a);if(!c)throw new Error("The {-y} placeholder requires a tile grid with extent");return(c.getHeight()-r[2]-1).toString()})}}function Ht(o,e){const t=o.length,i=new Array(t);for(let n=0;n<t;++n)i[n]=Wt(o[n],e);return Bt(i)}function Bt(o){return o.length===1?o[0]:function(e,t,i){if(!e)return;const n=bt(e),s=Ct(n,o.length);return o[s](e,t,i)}}function Vt(o){const e=[];let t=/\{([a-z])-([a-z])\}/.exec(o);if(t){const i=t[1].charCodeAt(0),n=t[2].charCodeAt(0);let s;for(s=i;s<=n;++s)e.push(o.replace(t[0],String.fromCharCode(s)));return e}if(t=/\{(\d+)-(\d+)\}/.exec(o),t){const i=parseInt(t[2],10);for(let n=parseInt(t[1],10);n<=i;n++)e.push(o.replace(t[0],n.toString()));return e}return e.push(o),e}class Ee extends qt{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Ee.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const t=e.target,i=I(t),n=t.getState();let s;n==u.LOADING?(this.tileLoadingKeys_[i]=!0,s=ue.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=n==u.ERROR?ue.TILELOADERROR:n==u.LOADED?ue.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new Nt(s,t))}setTileLoadFunction(e){this.tileCache.clear(),this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,this.tileCache.pruneExceptNewestZ(),typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){const t=Vt(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;const t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Ht(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}useTile(e,t,i){const n=re(e,t,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}class $t extends Ee{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,opaque:e.opaque,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:Qt,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Ke,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const e in this.tileCacheForProjection)if(this.tileCacheForProjection[e].canExpireCache())return!0;return!1}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const n in this.tileCacheForProjection){const s=this.tileCacheForProjection[n];s.expireCache(s==i?t:{})}}getGutterForProjection(e){return this.getProjection()&&e&&!N(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getOpaque(e){return this.getProjection()&&e&&!N(this.getProjection(),e)?!1:super.getOpaque(e)}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||N(t,e)))return this.tileGrid;const i=I(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=He(e)),this.tileGridForProjection[i]}getTileCacheForProjection(e){const t=this.getProjection();if(!t||N(t,e))return this.tileCache;const i=I(e);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new Ne(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(e,t,i,n,s,r){const l=[e,t,i],h=this.getTileCoordForTileUrlFunction(l,s),a=h?this.tileUrlFunction(h,n,s):void 0,c=new this.tileClass(l,a!==void 0?u.IDLE:u.EMPTY,a!==void 0?a:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=r,c.addEventListener(fe.CHANGE,this.handleTileChange.bind(this)),c}getTile(e,t,i,n,s){const r=this.getProjection();if(!r||!s||N(r,s))return this.getTileInternal(e,t,i,n,r||s);const l=this.getTileCacheForProjection(s),h=[e,t,i];let a;const c=qe(h);l.containsKey(c)&&(a=l.get(c));const d=this.getKey();if(a&&a.key==d)return a;const m=this.getTileGridForProjection(r),T=this.getTileGridForProjection(s),f=this.getTileCoordForTileUrlFunction(h,s),g=new ge(r,m,s,T,h,f,this.getTilePixelRatio(n),this.getGutter(),(y,x,E,p)=>this.getTileInternal(y,x,E,p,r),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return g.key=d,a?(g.interimTile=a,g.refreshInterimChain(),l.replace(c,g)):l.set(c,g),g}getTileInternal(e,t,i,n,s){let r=null;const l=re(e,t,i),h=this.getKey();if(!this.tileCache.containsKey(l))r=this.createTile_(e,t,i,n,s,h),this.tileCache.set(l,r);else if(r=this.tileCache.get(l),r.key!=h){const a=r;r=this.createTile_(e,t,i,n,s,h),a.getState()==u.IDLE?r.interimTile=a.interimTile:r.interimTile=a,r.refreshInterimChain(),this.tileCache.replace(l,r)}return r}setRenderReprojectionEdges(e){if(this.renderReprojectionEdges_!=e){this.renderReprojectionEdges_=e;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(e,t){const i=Te(e);if(i){const n=I(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=t)}}clear(){super.clear();for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear()}}function Qt(o,e){o.getImage().src=e}class Jt extends $t{constructor(e){e=e||{};const t=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:kt({extent:xe(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:e.opaque,projection:t,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const ei='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class ti extends Jt{constructor(e){e=e||{};let t;e.attributions!==void 0?t=e.attributions:t=[ei];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",n=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:t,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,opaque:e.opaque!==void 0?e.opaque:!0,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:n,wrapX:e.wrapX,zDirection:e.zDirection})}}const ne={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class ii extends yt{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getPreload(){return this.get(ne.PRELOAD)}setPreload(e){this.set(ne.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(ne.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(ne.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class ni extends wt{constructor(e){super(e),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=Ft(),this.tmpTileRange_=new _e(0,0,0,0)}isDrawableTile(e){const t=this.getLayer(),i=e.getState(),n=t.getUseInterimTilesOnError();return i==u.LOADED||i==u.EMPTY||i==u.ERROR&&!n}getTile(e,t,i,n){const s=n.pixelRatio,r=n.viewState.projection,l=this.getLayer();let a=l.getSource().getTile(e,t,i,s,r);return a.getState()==u.ERROR&&l.getUseInterimTilesOnError()&&l.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(a)||(a=a.getInterimTile()),a}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),n=je(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!Ue(s,n))return null;const r=t.pixelRatio,l=t.viewState.projection,h=t.viewState,a=i.getRenderSource(),c=a.getTileGridForProjection(h.projection),d=a.getTilePixelRatio(t.pixelRatio);for(let m=c.getZForResolution(h.resolution);m>=c.getMinZoom();--m){const T=c.getTileCoordForCoordAndZ(n,m),f=a.getTile(m,T[1],T[2],r,l);if(!(f instanceof Ke||f instanceof ge)||f instanceof ge&&f.getState()===u.EMPTY)return null;if(f.getState()!==u.LOADED)continue;const g=c.getOrigin(m),y=D(c.getTileSize(m)),x=c.getResolution(m),E=Math.floor(d*((n[0]-g[0])/x-T[1]*y[0])),p=Math.floor(d*((g[1]-n[1])/x-T[2]*y[1])),R=Math.round(d*a.getGutterForProjection(h.projection));return this.getImageData(f.getImage(),E+R,p+R)}return null}loadedTileCallback(e,t,i){return this.isDrawableTile(i)?super.loadedTileCallback(e,t,i):!1}prepareFrame(e){return!!this.getLayer().getSource()}renderFrame(e,t){const i=e.layerStatesArray[e.layerIndex],n=e.viewState,s=n.projection,r=n.resolution,l=n.center,h=n.rotation,a=e.pixelRatio,c=this.getLayer(),d=c.getSource(),m=d.getRevision(),T=d.getTileGridForProjection(s),f=T.getZForResolution(r,d.zDirection),g=T.getResolution(f);let y=e.extent;const x=e.viewState.resolution,E=d.getTilePixelRatio(a),p=Math.round(me(y)/x*a),R=Math.round(Me(y)/x*a),C=i.extent&&ve(i.extent);C&&(y=se(y,ve(i.extent)));const w=g*p/2/E,b=g*R/2/E,O=[l[0]-w,l[1]-b,l[0]+w,l[1]+b],Y=T.getTileRangeForExtentAndZ(y,f),W={};W[f]={};const pe=this.createLoadedTileFinder(d,s,W),Re=this.tmpExtent,Ce=this.tmpTileRange_;this.newTiles_=!1;const Ve=h?Xe(n.center,x,h,e.size):void 0;for(let X=Y.minX;X<=Y.maxX;++X)for(let F=Y.minY;F<=Y.maxY;++F){if(h&&!T.tileCoordIntersectsViewport([f,X,F],Ve))continue;const S=this.getTile(f,X,F,e);if(this.isDrawableTile(S)){const M=I(this);if(S.getState()==u.LOADED){W[f][S.tileCoord.toString()]=S;let U=S.inTransition(M);U&&i.opacity!==1&&(S.endTransition(M),U=!1),!this.newTiles_&&(U||!this.renderedTiles.includes(S))&&(this.newTiles_=!0)}if(S.getAlpha(M,e.time)===1)continue}const ae=T.getTileCoordChildTileRange(S.tileCoord,Ce,Re);let B=!1;ae&&(B=pe(f+1,ae)),B||T.forEachTileCoordParentTileRange(S.tileCoord,pe,Ce,Re)}const Q=g/r*a/E;Ae(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/a,1/a,h,-p/2,-R/2);const oe=St(this.pixelTransform);this.useContainer(t,oe,this.getBackground(e));const _=this.context,G=_.canvas;Pt(this.inversePixelTransform,this.pixelTransform),Ae(this.tempTransform,p/2,R/2,Q,Q,0,-p/2,-R/2),G.width!=p||G.height!=R?(G.width=p,G.height=R):this.containerReused||_.clearRect(0,0,p,R),C&&this.clipUnrotated(_,e,C),d.getInterpolate()||(_.imageSmoothingEnabled=!1),this.preRender(_,e),this.renderedTiles.length=0;let H=Object.keys(W).map(Number);H.sort(Lt);let Z,le,L;i.opacity===1&&(!this.containerReused||d.getOpaque(e.viewState.projection))?H=H.reverse():(Z=[],le=[]);for(let X=H.length-1;X>=0;--X){const F=H[X],S=d.getTilePixelSize(F,a,s),B=T.getResolution(F)/g,M=S[0]*B*Q,U=S[1]*B*Q,he=T.getTileCoordForCoordAndZ(be(O),F),ye=T.getTileCoordExtent(he),J=je(this.tempTransform,[E*(ye[0]-O[0])/g,E*(O[3]-ye[3])/g]),$e=E*d.getGutterForProjection(s),we=W[F];for(const Qe in we){const k=we[Qe],Fe=k.tileCoord,Se=he[1]-Fe[1],Je=Math.round(J[0]-(Se-1)*M),Pe=he[2]-Fe[2],et=Math.round(J[1]-(Pe-1)*U),z=Math.round(J[0]-Se*M),j=Math.round(J[1]-Pe*U),V=Je-z,$=et-j,Le=f===F,Ie=Le&&k.getAlpha(I(this),e.time)!==1;let ce=!1;if(!Ie)if(Z){L=[z,j,z+V,j,z+V,j+$,z,j+$];for(let ee=0,tt=Z.length;ee<tt;++ee)if(f!==F&&F<le[ee]){const P=Z[ee];It([z,j,z+V,j+$],[P[0],P[3],P[4],P[7]])&&(ce||(_.save(),ce=!0),_.beginPath(),_.moveTo(L[0],L[1]),_.lineTo(L[2],L[3]),_.lineTo(L[4],L[5]),_.lineTo(L[6],L[7]),_.moveTo(P[6],P[7]),_.lineTo(P[4],P[5]),_.lineTo(P[2],P[3]),_.lineTo(P[0],P[1]),_.clip())}Z.push(L),le.push(F)}else _.clearRect(z,j,V,$);this.drawTileImage(k,e,z,j,V,$,$e,Le),Z&&!Ie?(ce&&_.restore(),this.renderedTiles.unshift(k)):this.renderedTiles.push(k),this.updateUsedTiles(e.usedTiles,d,k)}}return this.renderedRevision=m,this.renderedResolution=g,this.extentChanged=!this.renderedExtent_||!Ot(this.renderedExtent_,O),this.renderedExtent_=O,this.renderedPixelRatio=a,this.renderedProjection=s,this.manageTilePyramid(e,d,T,a,s,y,f,c.getPreload()),this.scheduleExpireCache(e,d),this.postRender(_,e),i.extent&&_.restore(),_.imageSmoothingEnabled=!0,oe!==G.style.transform&&(G.style.transform=oe),this.container}drawTileImage(e,t,i,n,s,r,l,h){const a=this.getTileImage(e);if(!a)return;const c=I(this),d=t.layerStatesArray[t.layerIndex],m=d.opacity*(h?e.getAlpha(c,t.time):1),T=m!==this.context.globalAlpha;T&&(this.context.save(),this.context.globalAlpha=m),this.context.drawImage(a,l,l,a.width-2*l,a.height-2*l,i,n,s,r),T&&this.context.restore(),m!==d.opacity?t.animate=!0:h&&e.endTransition(c)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}scheduleExpireCache(e,t){if(t.canExpireCache()){const i=(function(n,s,r){const l=I(n);l in r.usedTiles&&n.expireCache(r.viewState.projection,r.usedTiles[l])}).bind(null,t);e.postRenderFunctions.push(i)}}updateUsedTiles(e,t,i){const n=I(t);n in e||(e[n]={}),e[n][i.getKey()]=!0}manageTilePyramid(e,t,i,n,s,r,l,h,a){const c=I(t);c in e.wantedTiles||(e.wantedTiles[c]={});const d=e.wantedTiles[c],m=e.tileQueue,T=i.getMinZoom(),f=e.viewState.rotation,g=f?Xe(e.viewState.center,e.viewState.resolution,f,e.size):void 0;let y=0,x,E,p,R,C,w;for(w=T;w<=l;++w)for(E=i.getTileRangeForExtentAndZ(r,w,E),p=i.getResolution(w),R=E.minX;R<=E.maxX;++R)for(C=E.minY;C<=E.maxY;++C)f&&!i.tileCoordIntersectsViewport([w,R,C],g)||(l-w<=h?(++y,x=t.getTile(w,R,C,n,s),x.getState()==u.IDLE&&(d[x.getKey()]=!0,m.isKeyQueued(x.getKey())||m.enqueue([x,c,i.getTileCoordCenter(x.tileCoord),p])),a!==void 0&&a(x)):t.useTile(w,R,C,s));t.updateCacheSize(y,s)}}class si extends ii{constructor(e){super(e)}createRenderer(){return new ni(this)}}const ri=si,oi="https://api.mapserverstudio.net/mapserver/?",li="map=/etc/mapserver/mapfiles/workshop/",ai=[new ri({source:new ti}),new zt({extent:[-13884991,2870341,-7455066,6338219],source:new jt({url:oi+li+"first.map&",params:{LAYERS:"states"},ratio:1})})];new vt({layers:ai,target:"map",view:new Xt({center:[-10997148,4569099],zoom:4})});
//# sourceMappingURL=first-DTGmSh8S.js.map
